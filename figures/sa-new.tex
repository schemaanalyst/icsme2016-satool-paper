\newcommand{\mx}[1]{\mathbf{\bm{#1}}} % Matrix command
\newcommand{\vc}[1]{\mathbf{\bm{#1}}} % Vector command

% Define the layers to draw the diagram
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}

% Define block styles used later

\tikzstyle{box}=[draw, line width=0.6mm, minimum width=9.5em, minimum height=4.5em]
\tikzstyle{box2}=[draw, line width=0.6mm, minimum width=7.5em, minimum height=4em]
\tikzstyle{box3}=[draw, line width=0.6mm, minimum width=7.5em, minimum height=9.5em]
\tikzstyle{box4}=[draw, line width=0.6mm, minimum width=7.5em, minimum height=14.5em]
\tikzstyle{sensor}=[draw, fill=black!10, text width=5em,
    text centered, minimum height=2.5em,drop shadow]
\tikzstyle{circle}=[draw, ellipse, fill=black!10, text width=5em,
    text centered, minimum height=2.5em, drop shadow]
\tikzstyle{smallcircle}=[draw, ellipse, fill=black!10, text width=4em,
    text centered, minimum height=2.5em, drop shadow]
\tikzstyle{sa}=[draw, fill=black!20, text width=5em,
    text centered, minimum height=15em, minimum width = 17em, drop shadow]
\tikzstyle{ann} = [above, text width=5em, text centered]
\tikzstyle{wa} = [sensor, text width=10em, fill=black!30,
    minimum height=6em, rounded corners, drop shadow]
\tikzstyle{sc} = [sensor, text width=13em, fill=red!30,
    minimum height=10em, rounded corners, drop shadow]


% Define distances for bordering
\def\blockdist{1.5}
\def\edgedist{2.5}

\begin{figure}[t]
  \centering

% VERTICAL
\begin{tikzpicture}[thick,scale=0.85, every node/.style={scale=0.85}]
    \node [sa] at (0, 0) (sa) {};
    % invisible node to T-shaped arrow
    \node [] at (3.75, 3.7) (t) {\texttt{sqlrepresentation}};
    % \node [] at (4.25, 2) (t2) {\textit{SchemaAnalyst}};
    \node [] at (3.65, -1.75) (t3) {\texttt{data}};
    \node [] at (-4.25, -1.75) (t4) {\texttt{javawriter}};
    \node [] at (-4.25, 1) (t5) {\texttt{test-}};
    \node [] at (-4.25, 0.75) (t5cont) {\texttt{generation}};
    \node [box] at (0, 3.7) (b1) {};
    \node [box2] at (-1.5, -1.75) (b2) {};
    \node [box3] at (-1.5, 0.8) (b3) {};
    \node [box4] at (1.5, -1.75) (b4) {};
    \node [circle] at (0, 3.7) (sc) {Database Schema};
    \node [sensor] at (-1.5, 1.75) (cc) {Coverage Criterion};
    \node [smallcircle] at (-1.5, 0) (tr) {Test \\ Reqs.};
    \node [sensor] at (1.5, 0) (dg) {Data Generator};
    \node [sensor] at (-1.5, -1.75) (tsw) {Test Suite Writer};
    \node [] at (1.62, -1.75) (inv) {};
    \node [circle] at (-1.5, -3.5) (jts) {JUnit \\ Test Suite};
    \node [smallcircle] at (1.5, -3.5) (td) {Test \\Data};

    \path [draw, ->] (sc.west) -| node [above] {}
        (cc.90);
    \path [draw, ->] (sc.east) -| node [above] {}
        (dg.90);
    \path [draw, ->] (cc.south) -- node [above] {}
        (tr.90);
    \path [draw, ->] (tr.east) -- node [above] {}
        (dg.180);
    \path [draw, ->] (dg.south) -- node [above] {}
        (td.90);
    \path [draw, ->] (tsw.south) -- node [above] {}
        (jts.90);
    \path [draw, ->] (inv.west) -- node [above] {}
        (tsw.0);

    % \path [draw]  (t2.west) +(-0.3,0) -- +(0.15,0) node [above] {}
    %     (sa.70);
    \path [draw]  (t.west) +(-0.15,0) -- +(0.1,0) node [above] {}
        (b1.0);
    \path [draw]  (t3.west) +(-0.25,0) -- +(0.1,0) node [above] {}
        (b3.0);
    \path [draw]  (t4.east) +(-0.1,0) -- +(0.25,0) node [above] {}
        (b2.0);
    \path [draw]  (t5cont.east) +(-0.1,0) -- +(0.25,0) node [above] {}
        (b4.0);

\end{tikzpicture}
\caption{\label{fig:schemaanalyst}The inputs and outputs of the
\textit{SchemaAnalyst} tool.}
\end{figure}
